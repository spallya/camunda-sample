<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_0pra3e7" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.12.1" modeler:executionPlatform="Camunda Platform" modeler:executionPlatformVersion="7.19.0">
  <bpmn:process id="variableDocTemplateCreation" name="Variable Doc Template Creation" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>Flow_1nv6tmq</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:endEvent id="Event_0li0bxt">
      <bpmn:incoming>Flow_0fb6gw7</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_1nv6tmq" sourceRef="StartEvent_1" targetRef="Activity_07skzsv" />
    <bpmn:sequenceFlow id="Flow_0fmb440" sourceRef="Activity_07skzsv" targetRef="Activity_1207ncw" />
    <bpmn:userTask id="Activity_07skzsv" name="Load variable doc template creation form" camunda:formRef="variableTemplateForm" camunda:formRefBinding="deployment" camunda:assignee="admin">
      <bpmn:extensionElements />
      <bpmn:incoming>Flow_1nv6tmq</bpmn:incoming>
      <bpmn:outgoing>Flow_0fmb440</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_163kbmj" sourceRef="Activity_1207ncw" targetRef="Activity_1dfcghj" />
    <bpmn:serviceTask id="Activity_1207ncw" name="Format Data" camunda:delegateExpression="#{formatDataForVariableTemplate}">
      <bpmn:incoming>Flow_0fmb440</bpmn:incoming>
      <bpmn:outgoing>Flow_163kbmj</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_1dfcghj" name="Insert into template table" camunda:delegateExpression="#{databaseQueryExecutorDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="query">insert into `vider_test`.`qtm_template` (`name`, `template_category_id`, `labels`, `metadata`, `description`, `template_name`, `updated_by`, `google_drivelink`, `version`, `last_updated`, `excerpt`, `saved`) values ('${name}', ${templateCategoryId}, '${labelsJson}', '${metadataJson}', '${description}', '${templateId}', 'admin', '${googleDriveLink}', 1, current_timestamp(), '${excerpt}', 0);</camunda:inputParameter>
          <camunda:inputParameter name="resultVariable">variableTemplateInsertResult</camunda:inputParameter>
          <camunda:inputParameter name="upsert">Y</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_163kbmj</bpmn:incoming>
      <bpmn:outgoing>Flow_0fb6gw7</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0fb6gw7" sourceRef="Activity_1dfcghj" targetRef="Event_0li0bxt" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="variableDocTemplateCreation">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="152" y="102" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1athkqx_di" bpmnElement="Activity_07skzsv">
        <dc:Bounds x="270" y="80" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_09ej1d9_di" bpmnElement="Activity_1207ncw">
        <dc:Bounds x="430" y="80" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0li0bxt_di" bpmnElement="Event_0li0bxt">
        <dc:Bounds x="742" y="102" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0es97k5_di" bpmnElement="Activity_1dfcghj">
        <dc:Bounds x="580" y="80" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1nv6tmq_di" bpmnElement="Flow_1nv6tmq">
        <di:waypoint x="188" y="120" />
        <di:waypoint x="270" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0fmb440_di" bpmnElement="Flow_0fmb440">
        <di:waypoint x="370" y="120" />
        <di:waypoint x="430" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_163kbmj_di" bpmnElement="Flow_163kbmj">
        <di:waypoint x="530" y="120" />
        <di:waypoint x="580" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0fb6gw7_di" bpmnElement="Flow_0fb6gw7">
        <di:waypoint x="680" y="120" />
        <di:waypoint x="742" y="120" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
